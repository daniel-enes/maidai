<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{components/layout}">
<head>
    <title>Projeto</title>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>

</head>
<body>
<main class="light flex-grow-8 padding-20"  layout:fragment="content">
    <h1>Projeto</h1>
    <div th:replace="~{components/alert :: alert}"></div>
    <div class="max-width-800px" th:if="${project.id != null}">
        <dl th:object="${project}">
            <dt>Nome:</dt>
            <dd th:text="*{name}"></dd>
            <dt>Inicío em:</dt>
            <dd th:text="*{start}"></dd>
            <dt>Término em:</dt>
            <dd th:text="*{end}"></dd>
            <dt>Empresa:</dt>
            <dd th:text="*{company.name}"></dd>
            <dt>Orientador:</dt>
            <dd>
                <a th:text="*{advisor.name}" th:href="@{/people/{id}(id=${project.advisor.id})}"></a>
            </dd>
            <dt>Coorientador(es):</dt>
            <dd th:if="${#lists.isEmpty(project.coAdvisors)}">
                <mark>Nenhum coorientador cadastrado.</mark>
            </dd>
            <th:block th:if="${not #lists.isEmpty(project.coAdvisors)}">
                <dd th:each="coadvisor : ${project.coAdvisors}">
                    <a th:text="${coadvisor.name}" th:href="@{/people/{id}(id=${coadvisor.id})}"></a>

                    <a th:href="@{/projects/{id}/relationships/people/{personId}(id=${project.id}, personId=${coadvisor.id})}"
                       th:data-url="@{/projects/{id}/relationships/people/{personId}(id=${project.id}, personId=${coadvisor.id})}"
                       onclick="return deleteEntity(this.getAttribute('data-url'), event)"
                       role="button"
                       aria-label="Remover coorientador do projeto"
                    >
                        <svg class="vertical-align-middle" width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="#03a696" d="M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z"/></svg>
                    </a>
                </dd>
            </th:block>
        </dl>
        <div class="margin-y-40">
            <fieldset>
                <legend>Adicionar coorientador ao projeto</legend>

                <form th:if="${!advisorList.empty}" method="post" th:action="@{/projects/{id}/relationships/people(id=${project.id})}">

                    <!--<input type="hidden" name="_method" value="patch">-->
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                    <div>
                        <select id="coAdvisorId" name="coAdvisorId" required>
                            <option value="">--- Selecione um coorientador ---</option>
                            <option th:each="advisor : ${advisorList}"
                                    th:value="${advisor.id}"
                                    th:text="${advisor.name}">
                            </option>
                        </select>
                    </div>

                    <div>
                        <button type="submit" class="button success font-light">
                            Adicionar
                        </button>
                    </div>
                </form>
            </fieldset>
        </div>

    </div>
</main>
</body>
</html>